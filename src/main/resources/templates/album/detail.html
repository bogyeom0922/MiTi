<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Detail</title>
    <script type="text/javascript">
        function formatDuration(ms) {
            var minutes = Math.floor(ms / 60000);
            var seconds = ((ms % 60000) / 1000).toFixed(0);
            return minutes + ":" + (seconds < 10 ? '0' : '') + seconds;
        }
    </script>
</head>
<body>
<div th:if="${firstAlbum != null}">
    <h1  th:text="${firstAlbum.detail}"></h1>
    <img th:src="@{${firstAlbum.album_image}}" alt="First Album Image" width="300px">
    <p th:text="${firstAlbum.music_artist_name}"></p>
    <p>followers: <span th:text="${firstAlbum.music_artist_followers}"></span></p>
    <p>artist genres: <span th:text="${firstAlbum.music_artist_genres}"></span></p>
</div>
<hr>
<ul style="list-style-type: none;">
    <li th:each="album, iterStat : ${albums}">
        <span th:text="${iterStat.index + 1} + '. ' + ${album.music_name}"></span>
        <script th:inline="javascript">
            var duration = /*[[${album.music_duration_ms}]]*/ '0';
            document.write(formatDuration(duration));
        </script>
    </li>
</ul>

<form>
    <input type="text" name="userId" id="userId" />
    <input type="text" name="albumId" id="albumId" />
    <textarea name="comment" id="comment"></textarea>
    <button type="button" onclick="submitComment()">댓글 작성</button>
</form>


<script>
    function submitComment() {
        var userId = document.getElementById('userId').value;
        var albumId = document.getElementById('albumId').value;
        var comment = document.getElementById('comment').value;

        // 데이터를 JSON 형태로 만들어 서버로 전송
        var data = {
            userId: userId,
            albumId: albumId,
            comment: comment
        };

        // 서버로 데이터 전송하는 로직
        fetch('/submitComment', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
        }).then(function(response) {
            // 응답 처리
            if (response.ok) {
                console.log('Comment submitted successfully');
            } else {
                console.error('Failed to submit comment');
            }
        }).catch(function(error) {
            console.error('Error submitting comment:', error);
        });
    }

</script>



</body>
</html>
