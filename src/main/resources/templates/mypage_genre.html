<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>유저 선호 장르</title>
</head>
<body>
<div class="layout">
    <button th:onclick="|location.href='@{/mypage/record/{userId}(userId=${userId})}'|">음악 기록</button>
    <button th:onclick="|location.href='@{/mypage/like/{userId}(userId=${userId})}'|">좋아요</button>
    <button th:onclick="|location.href='@{/mypage/genre/{userId}(userId=${userId})}'|">선호 장르</button>
    <button th:onclick="|location.href='@{/mypage/comment/{userId}(userId=${userId})}'|">댓글</button>
    <button th:onclick="|location.href='@{/mypage/playlist/{userId}(userId=${userId})}'|">플레이리스트</button>

</div>

<table>
    <tr>
        <th>선호 장르</th>
    </tr>

    <tr th:each="post : ${postList}">
        <td>
            <img th:src="@{${post.genre_image}}" width="50">
            <span th:text="${post.genre}"></span>
        </td>
        <td>
            <button th:onclick="'deleteGenre(' + ${post.id} + ')'" class="btn btn-danger">삭제</button>
        </td>



    </tr>

    <td>
        <button th:onclick="" class="btn btn-danger">장르 추가</button>
    </td>
</table>

<script>
    function deleteGenre(id) {
        console.log(`Deleting genre with id: ${id}`);
        fetch(`/mypage/genre/${id}`, {
            method: 'DELETE'
        })
            .then(response => response.text())
            .then(result => {
                console.log(`Response: ${result}`);
                if (result === 'success') {
                    location.reload();
                } else {
                    alert('삭제 실패');
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
    }
</script>

</body>
</html>
